(async function() {while (!Spicetify.React || !Spicetify.ReactDOM) {await new Promise(resolve => setTimeout(resolve, 10));}var lucid=(()=>{var tr=Object.create;var it=Object.defineProperty;var or=Object.getOwnPropertyDescriptor;var rr=Object.getOwnPropertyNames;var nr=Object.getPrototypeOf,ir=Object.prototype.hasOwnProperty;var We=(e,o)=>()=>(o||e((o={exports:{}}).exports,o),o.exports);var ar=(e,o,t,r)=>{if(o&&typeof o=="object"||typeof o=="function")for(let n of rr(o))!ir.call(e,n)&&n!==t&&it(e,n,{get:()=>o[n],enumerable:!(r=or(o,n))||r.enumerable});return e};var u=(e,o,t)=>(t=e!=null?tr(nr(e)):{},ar(o||!e||!e.__esModule?it(t,"default",{value:e,enumerable:!0}):t,e));var m=We((Fn,at)=>{at.exports=Spicetify.React});var fo=We((fs,go)=>{"use strict";var en="bold|bolder|lighter|[1-9]00",tn="italic|oblique",on="small-caps",rn="ultra-condensed|extra-condensed|condensed|semi-condensed|semi-expanded|expanded|extra-expanded|ultra-expanded",nn="px|pt|pc|in|cm|mm|%|em|ex|ch|rem|q",mo=`'([^']+)'|"([^"]+)"|[\\w\\s-]+`,an=new RegExp(`(${en}) +`,"i"),sn=new RegExp(`(${tn}) +`,"i"),ln=new RegExp(`(${on}) +`,"i"),cn=new RegExp(`(${rn}) +`,"i"),dn=new RegExp(`([\\d\\.]+)(${nn}) *((?:${mo})( *, *(?:${mo}))*)`),et={},pn=16;go.exports=e=>{if(et[e])return et[e];let o=dn.exec(e);if(!o)return;let t={weight:"normal",style:"normal",stretch:"normal",variant:"normal",size:parseFloat(o[1]),unit:o[2],family:o[3].replace(/["']/g,"").replace(/ *, */g,",")},r,n,i,a,l=e.substring(0,o.index);switch((r=an.exec(l))&&(t.weight=r[1]),(n=sn.exec(l))&&(t.style=n[1]),(i=ln.exec(l))&&(t.variant=i[1]),(a=cn.exec(l))&&(t.stretch=a[1]),t.unit){case"pt":t.size/=.75;break;case"pc":t.size*=16;break;case"in":t.size*=96;break;case"cm":t.size*=96/2.54;break;case"mm":t.size*=96/25.4;break;case"%":break;case"em":case"rem":t.size*=pn/.75;break;case"q":t.size*=96/25.4/4;break}return et[e]=t}});var yo=We(ve=>{var un=fo();ve.parseFont=un;ve.createCanvas=function(e,o){return Object.assign(document.createElement("canvas"),{width:e,height:o})};ve.createImageData=function(e,o,t){switch(arguments.length){case 0:return new ImageData;case 1:return new ImageData(e);case 2:return new ImageData(e,o);default:return new ImageData(e,o,t)}};ve.loadImage=function(e,o){return new Promise(function(t,r){let n=Object.assign(document.createElement("img"),o);function i(){n.onload=null,n.onerror=null}n.onload=function(){i(),t(n)},n.onerror=function(){i(),r(new Error('Failed to load the image "'+e+'"'))},n.src=e})}});var T=u(m()),sr=(0,T.memo)(({title:e,children:o,headingChild:t,onClose:r,isOpen:n=!1})=>n?T.default.createElement("div",{className:"modal-container"},T.default.createElement("div",{className:`modal-overlay ${n&&"open"}`,style:{zIndex:20},onClick:r}),T.default.createElement("dialog",{open:n,className:`modal-section ${n&&"open"}`,"aria-label":e,"aria-modal":"true"},T.default.createElement("div",{className:"main-embedWidgetGenerator-container"},T.default.createElement("div",{className:"main-trackCreditsModal-header"},T.default.createElement("h1",{className:"encore-text encore-title-body-medium"},e),t&&T.default.createElement("div",null,t),T.default.createElement("button",{type:"button","aria-label":"Close",className:"main-trackCreditsModal-closeBtn",onClick:()=>r()},T.default.createElement("svg",{width:"18",height:"18",viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg"},T.default.createElement("title",null,"Close"),T.default.createElement("path",{d:"M31.098 29.794L16.955 15.65 31.097 1.51 29.683.093 15.54 14.237 1.4.094-.016 1.508 14.126 15.65-.016 29.795l1.414 1.414L15.54 17.065l14.144 14.143",fill:"currentColor","fill-rule":"evenodd"})))),T.default.createElement("div",{className:"modal-contents"},T.default.createElement("main",{className:"modal-wrapper"},o))))):null),Pe=sr;var ge=u(m()),lr=({title:e,description:o,children:t})=>ge.default.createElement("div",{className:"setting-section"},ge.default.createElement("div",{className:"heading-wrapper"},ge.default.createElement("h3",{className:"title encore-text encore-text-title-small"},e),o&&ge.default.createElement("p",{className:"desc encore-text encore-text-body-small"},o)),t),V=lr;var st=[{label:"Animated",value:"animated"},{label:"Static",value:"static"},{label:"Solid",value:"solid"}],lt=[{label:"All elements",value:"full"},{label:"Accent color only",value:"basic"}],ct=[{label:"Compact",value:"compact"},{label:"Default",value:"default"},{label:"Rounded",value:"rounded"}],dt=[{label:"Starry",value:"starry"},{label:"Default",value:"default"},{label:"none",value:"none"}],pt=[{label:"Now Playing",value:"now-playing"},{label:"Playlist Cover",value:"inherit"},{label:"none",value:"none"}],ut=[{label:"Card",value:"card"},{label:"Compact Card",value:"compact-card"},{label:"Compact",value:"compact"},{label:"Default",value:"default"}],mt=[{label:"None",value:"none"},{label:"Hidden",value:"hidden"},{label:"Dotted",value:"dotted"},{label:"Dashed",value:"dashed"},{label:"Solid",value:"solid"},{label:"Double",value:"double"},{label:"Groove",value:"groove"},{label:"Ridge",value:"ridge"},{label:"Inset",value:"inset"},{label:"Outset",value:"outset"}];var gt=[{label:"Profile Context Menu",value:"context-menu"},{label:"Global Nav",value:"nav"}],ft=[{label:"Compact",value:"compact"},{label:"Normal",value:"normal"}],yt=[{label:"Left",value:"left"},{label:"Right",value:"right"}];var ze=u(m()),cr=()=>ze.default.createElement("svg",{role:"img","aria-label":"dismiss",width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},ze.default.createElement("path",{d:"m4.21 4.387.083-.094a1 1 0 0 1 1.32-.083l.094.083L12 10.585l6.293-6.292a1 1 0 1 1 1.414 1.414L13.415 12l6.292 6.293a1 1 0 0 1 .083 1.32l-.083.094a1 1 0 0 1-1.32.083l-.094-.083L12 13.415l-6.293 6.292a1 1 0 0 1-1.414-1.414L10.585 12 4.293 5.707a1 1 0 0 1-.083-1.32l.083-.094-.083.094Z",fill:"#ffffff"})),bt=cr;var qe=u(m()),dr=({variant:e="primary",size:o="medium",icon:t,children:r,...n})=>qe.default.createElement("button",{className:`button button-${e} button-${o}`,...n},t&&qe.default.createElement("span",{className:"button-icon"},t),r),z=dr;var q=u(m()),pr=0,ur=(()=>{let e;return{ToastContainer:()=>{let[t,r]=(0,q.useState)([]);e=(0,q.useCallback)((a,l=!1)=>{let c=pr++;r(s=>[...s,{id:c,message:a,isError:l,exiting:!1}]);let d=setTimeout(()=>{i(c)},3e3);return()=>clearTimeout(d)},[]);let i=a=>{r(l=>l.map(c=>c.id===a?{...c,exiting:!0}:c)),setTimeout(()=>{r(l=>l.filter(c=>c.id!==a))},500)};return q.default.createElement("div",{className:"toast-container"},t.map(a=>q.default.createElement("div",{key:a.id,className:`toast-element ${a.exiting?"toast-exit":""}`,style:{backgroundColor:`${a.isError?"rgba(200,20,20,0.5)":"rgba(20,20,20,0.5)"}`}},a.message,q.default.createElement(z,{icon:q.default.createElement(bt,null),onClick:()=>i(a.id)}))))},addToast:(t,r)=>e(t,r)}})(),{ToastContainer:St,addToast:R}=ur;var ht=e=>{let o,t=new Set,r=(d,s)=>{let g=typeof d=="function"?d(o):d;if(!Object.is(g,o)){let f=o;o=s??(typeof g!="object"||g===null)?g:Object.assign({},o,g),t.forEach(p=>p(o,f))}},n=()=>o,l={setState:r,getState:n,getInitialState:()=>c,subscribe:d=>(t.add(d),()=>t.delete(d))},c=o=e(r,n,l);return l},vt=e=>e?ht(e):ht;var Ze=u(m(),1);var mr=e=>e;function gr(e,o=mr){let t=Ze.default.useSyncExternalStore(e.subscribe,()=>o(e.getState()),()=>o(e.getInitialState()));return Ze.default.useDebugValue(t),t}var wt=e=>{let o=vt(e),t=r=>gr(o,r);return Object.assign(t,o),t},se=e=>e?wt(e):wt;function fr(e,o){let t;try{t=e()}catch{return}return{getItem:n=>{var i;let a=c=>c===null?null:JSON.parse(c,o?.reviver),l=(i=t.getItem(n))!=null?i:null;return l instanceof Promise?l.then(a):a(l)},setItem:(n,i)=>t.setItem(n,JSON.stringify(i,o?.replacer)),removeItem:n=>t.removeItem(n)}}var Je=e=>o=>{try{let t=e(o);return t instanceof Promise?t:{then(r){return Je(r)(t)},catch(r){return this}}}catch(t){return{then(r){return this},catch(r){return Je(r)(t)}}}},yr=(e,o)=>(t,r,n)=>{let i={storage:fr(()=>localStorage),partialize:y=>y,version:0,merge:(y,C)=>({...C,...y}),...o},a=!1,l=new Set,c=new Set,d=i.storage;if(!d)return e((...y)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),t(...y)},r,n);let s=()=>{let y=i.partialize({...r()});return d.setItem(i.name,{state:y,version:i.version})},g=n.setState;n.setState=(y,C)=>{g(y,C),s()};let f=e((...y)=>{t(...y),s()},r,n);n.getInitialState=()=>f;let p,k=()=>{var y,C;if(!d)return;a=!1,l.forEach(b=>{var x;return b((x=r())!=null?x:f)});let M=((C=i.onRehydrateStorage)==null?void 0:C.call(i,(y=r())!=null?y:f))||void 0;return Je(d.getItem.bind(d))(i.name).then(b=>{if(b)if(typeof b.version=="number"&&b.version!==i.version){if(i.migrate){let x=i.migrate(b.state,b.version);return x instanceof Promise?x.then(_=>[!0,_]):[!0,x]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,b.state];return[!1,void 0]}).then(b=>{var x;let[_,W]=b;if(p=i.merge(W,(x=r())!=null?x:f),t(p,!0),_)return s()}).then(()=>{M?.(p,void 0),p=r(),a=!0,c.forEach(b=>b(p))}).catch(b=>{M?.(void 0,b)})};return n.persist={setOptions:y=>{i={...i,...y},y.storage&&(d=y.storage)},clearStorage:()=>{d?.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>k(),hasHydrated:()=>a,onHydrate:y=>(l.add(y),()=>{l.delete(y)}),onFinishHydration:y=>(c.add(y),()=>{c.delete(y)})},i.skipHydration||k(),p||f},Ie=yr;var Ct={isUseLocalImage:!1,selectedLocalImage:null},le=se(Ie(e=>({...Ct,setUseLocalImage:o=>e(()=>({isUseLocalImage:o})),setSelectedLocalImage:o=>e(()=>({selectedLocalImage:o})),clearSelectedLocalImage:()=>e(()=>({...Ct}))}),{name:"lucid-bg-image"}));var br={solid:{opacity:1,backgroundColor:"var(--spice-main)"},static:{blur:32,opacity:1,saturation:1.1,contrast:1.2,brightness:.5},animated:{blur:32,time:45,opacity:1,saturation:1.1,contrast:1.2,brightness:.475}},Sr={compact:{height:64,opacity:1,saturation:1.1,contrast:1.2,brightness:.8,borderRadius:8,backdropBlur:32,paddingX:6,backgroundColor:"rgba(var(--spice-rgb-player, var(--spice-rgb-card)), 0.5)"},default:{height:80,opacity:1,paddingX:6,saturation:1.1,contrast:1.2,borderRadius:8,brightness:.8,backdropBlur:32,backgroundColor:"rgba(var(--spice-rgb-player, var(--spice-rgb-card)), 0.5)"},rounded:{height:80,opacity:1,paddingX:20,saturation:1.1,contrast:1.2,borderRadius:999,brightness:.8,backdropBlur:32,backgroundColor:"rgba(var(--spice-rgb-player, var(--spice-rgb-card)), 0.5)"}},Ee={backgroundSettings:{mode:"static",styles:br,customBackgroundOverride:{url:null}},interfaceSettings:{controlSettings:{height:64},fontSettings:{body:{url:"https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap",fontFamily:"Poppins"}},grainSettings:{grainEffect:"default"},pagesSettings:{isScrollMode:!1,backgroundImageMode:"inherit",playlistViewMode:"card"},borderSettings:{color:"rgba(var(--spice-rgb-selected-row, var(--spice-rgb-text)), 0.125)",style:"inset",thickness:1,roundedRadius:12}},npvSettings:{mode:"normal",position:"right",blur:24},colorSettings:{isDynamicColor:!1,dynamicColorMode:"full"},playbarSettings:{mode:"default",styles:Sr},settingAccessPosition:"nav"};var hr=e=>typeof e=="object"&&e!==null&&"backgroundSettings"in e&&"interfaceSettings"in e&&"playbarSettings"in e&&"colorSettings"in e&&typeof e.backgroundSettings=="object"&&"mode"in e.backgroundSettings&&"styles"in e.backgroundSettings&&typeof e.interfaceSettings=="object"&&"borderSettings"in e.interfaceSettings&&"fontSettings"in e.interfaceSettings&&typeof e.playbarSettings=="object"&&"mode"in e.playbarSettings&&typeof e.colorSettings=="object"&&"isDynamicColor"in e.colorSettings&&"dynamicColorMode"in e.colorSettings,S=se(Ie((e,o)=>({...Ee,exportSettings:()=>{let t=o();return JSON.stringify(t)},importSettings:t=>{try{let r=JSON.parse(t);if(!hr(r))throw new Error("Invalid settings structure");return e(r),R("Settings imported successfully!"),!0}catch(r){let n=r instanceof SyntaxError?"Failed to parse JSON: Please ensure your input is valid JSON.":r instanceof Error?r.message:"An unknown error occurred.";return R(n,!0),!1}},setBackgroundSettings:t=>e(r=>({backgroundSettings:{...r.backgroundSettings,...t}})),setNpvMode:t=>e(r=>({npvSettings:{...r.npvSettings,mode:t}})),setNpvBlur:t=>e(r=>({npvSettings:{...r.npvSettings,blur:t}})),setCompactNpvPosition:t=>e(r=>({npvSettings:{...r.npvSettings,position:t}})),setSettingAccessPosition:t=>e(()=>({settingAccessPosition:t})),setControlHeight:t=>e(r=>({interfaceSettings:{...r.interfaceSettings,controlSettings:{height:t}}})),setCustomBackgroundOverride:t=>e(r=>({backgroundSettings:{...r.backgroundSettings,customBackgroundOverride:{...r.backgroundSettings.customBackgroundOverride,url:t}}})),setBorderColor:t=>e(r=>({interfaceSettings:{...r.interfaceSettings,borderSettings:{...r.interfaceSettings.borderSettings,color:t}}})),setBorderStyle:t=>e(r=>({interfaceSettings:{...r.interfaceSettings,borderSettings:{...r.interfaceSettings.borderSettings,style:t}}})),setRoundedBorderRadius:t=>e(r=>({interfaceSettings:{...r.interfaceSettings,borderSettings:{...r.interfaceSettings.borderSettings,roundedRadius:t}}})),setBorderThickness:t=>e(r=>({interfaceSettings:{...r.interfaceSettings,borderSettings:{...r.interfaceSettings.borderSettings,thickness:t}}})),setBackgroundStyles:(t,r)=>e(n=>({backgroundSettings:{...n.backgroundSettings,styles:{...n.backgroundSettings.styles,[r]:{...n.backgroundSettings.styles[r],...t}}}})),setColorSettings:t=>e(r=>({colorSettings:{...r.colorSettings,...t}})),setBorderSettings:t=>e(r=>({interfaceSettings:{...r.interfaceSettings,borderSettings:{...r.interfaceSettings.borderSettings,...t}}})),setPlaybarSettings:t=>e(r=>({playbarSettings:{...r.playbarSettings,...t}})),setInterfaceSettings:t=>e(r=>({interfaceSettings:{...r.interfaceSettings,...t}})),setBackgroundMode:t=>e(r=>({backgroundSettings:{...r.backgroundSettings,mode:t}})),updateBackgroundStyle:(t,r,n)=>e(i=>({backgroundSettings:{...i.backgroundSettings,styles:{...i.backgroundSettings.styles,[t]:{...i.backgroundSettings.styles[t],[r]:n}}}})),setFont:(t,r)=>e(n=>({interfaceSettings:{...n.interfaceSettings,fontSettings:{...n.interfaceSettings.fontSettings,[t]:{...r}}}})),setGrainEffect:t=>e(r=>({interfaceSettings:{...r.interfaceSettings,grainSettings:{...r.interfaceSettings.grainSettings,grainEffect:t}}})),setIsScrollMode:t=>e(r=>({interfaceSettings:{...r.interfaceSettings,pagesSettings:{...r.interfaceSettings.pagesSettings,isScrollMode:t}}})),setPagesBackgroundImageMode:t=>e(r=>({interfaceSettings:{...r.interfaceSettings,pagesSettings:{...r.interfaceSettings.pagesSettings,backgroundImageMode:t}}})),setPlaylistViewMode:t=>e(r=>({interfaceSettings:{...r.interfaceSettings,pagesSettings:{...r.interfaceSettings.pagesSettings,playlistViewMode:t}}})),setIsDynamicColor:t=>e(r=>({colorSettings:{...r.colorSettings,isDynamicColor:t}})),setDynamicColorMode:t=>e(r=>({colorSettings:{...r.colorSettings,dynamicColorMode:t}})),updatePlaybarStyle:(t,r,n)=>e(i=>({playbarSettings:{...i.playbarSettings,styles:{...i.playbarSettings.styles,[t]:{...i.playbarSettings.styles[t],[r]:n}}}})),setPlaybarMode:t=>e(r=>({playbarSettings:{...r.playbarSettings,mode:t}})),resetAllSettings:()=>{e(Ee)}}),{name:"lucid-settings",version:1.1,migrate:e=>({...Ee,...e})}));var Ye=e=>{try{return new URL(e),!0}catch{return!1}},vr=e=>decodeURIComponent(e.match(/family=([^&:]+)/)?.[1]?.replace(/\+/g," ")||"")||"",Mt=(e,o)=>{let t=document.getElementById(o);t||(t=document.createElement("link"),t.rel="stylesheet",t.id=o,document.head.appendChild(t)),t.href=e},kt=e=>{let o="",t="";return Ye(e)?(t=e,o=vr(e)):(t=e,o=e),{url:t,fontFamily:o}};var Le=(e,o,t)=>Object.entries(e[o]).map(([r,n])=>({id:`style-${o}`,sectionName:"Styles",conditionalRender:!0,cardProps:{title:`Set ${r}`,type:"input",settings:{label:"",defaultValue:n,...typeof n=="number"?{type:"number",onChange:i=>{t(o,r,Number(i))},settings:{max:256,min:0,step:.5}}:{type:"text",onChange:i=>{t(o,r,i)}}}}}));var wr=console.log,Cr=console.debug,Mr=console.error,kr=console.warn,xt={prefix:"font-weight: bold; color: #4DB6AC; font-size: 0.85rem;",error:"color: #dc3545;",warn:"color: #ffc107;",debug:"color: #17a2b8;",info:""},Te=(e,o,...t)=>{let r={info:wr,debug:Cr,error:Mr,warn:kr}[e],n=xt[e];r(`%c[Lucid] %c${o}`,xt.prefix,n,...t)},j=(e,...o)=>Te("info",e,...o),v=(e,...o)=>Te("debug",e,...o),w=(e,...o)=>Te("error",e,...o),Ne=(e,...o)=>Te("warn",e,...o);var te=u(m()),xr=({children:e})=>te.default.createElement("div",{className:"tooltip-container"},te.default.createElement("div",{className:"tooltip"},te.default.createElement("span",{className:"tooltip-icon"},te.default.createElement("svg",{role:"img","aria-label":"Tooltip icon",width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},te.default.createElement("path",{d:"M12 2c5.523 0 10 4.478 10 10s-4.477 10-10 10S2 17.522 2 12 6.477 2 12 2Zm0 1.667c-4.595 0-8.333 3.738-8.333 8.333 0 4.595 3.738 8.333 8.333 8.333 4.595 0 8.333-3.738 8.333-8.333 0-4.595-3.738-8.333-8.333-8.333ZM12 15.5a1 1 0 1 1 0 2 1 1 0 0 1 0-2Zm0-8.75a2.75 2.75 0 0 1 2.75 2.75c0 1.01-.297 1.574-1.051 2.359l-.169.171c-.622.622-.78.886-.78 1.47a.75.75 0 0 1-1.5 0c0-1.01.297-1.574 1.051-2.359l.169-.171c.622-.622.78-.886.78-1.47a1.25 1.25 0 0 0-2.493-.128l-.007.128a.75.75 0 0 1-1.5 0A2.75 2.75 0 0 1 12 6.75Z",fill:"currentColor"}))),te.default.createElement("span",{className:"tooltip-content"},e))),Pt=xr;var ce=u(m()),Pr=({title:e,tooltip:o,selectedValue:t})=>ce.default.createElement("div",{className:"title-container"},ce.default.createElement("div",{className:"title-wrapper"},e&&ce.default.createElement("h5",{className:"encore-text encore-text-body-medium-bold"},e),o&&ce.default.createElement(Pt,null,o)),t&&ce.default.createElement("p",{className:"selected-value"},"Selected: ",t)),It=Pr;var Xe=u(m()),Ir=()=>Xe.default.createElement("svg",{role:"img","aria-label":"Arrow Down",width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},Xe.default.createElement("path",{d:"M4.293 8.293a1 1 0 0 1 1.414 0L12 14.586l6.293-6.293a1 1 0 1 1 1.414 1.414l-7 7a1 1 0 0 1-1.414 0l-7-7a1 1 0 0 1 0-1.414Z",fill:"#ffffff"})),Et=Ir;var E=u(m()),Er=({options:e,selectedValue:o,onChange:t,placeholder:r,disabled:n})=>{let i=(0,E.useRef)(null),[a,l]=(0,E.useState)(!1),c=()=>{l(s=>!s)},d=s=>{l(!1),t(s)};return(0,E.useEffect)(()=>{let s=g=>{i.current&&!i.current.contains(g.target)&&l(!1)};return document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s)},[]),E.default.createElement(E.default.Fragment,null,E.default.createElement("div",{className:"dropdown-container",ref:i},E.default.createElement("button",{className:`dropdown-button ${a?"open":""}`,onClick:c,"aria-label":"Toggle dropdown menu",type:"button"},E.default.createElement("p",{className:"encore-text"},r||o||"Dropdown"),E.default.createElement("span",{className:"dropdown-arrow"},E.default.createElement(Et,null))),E.default.createElement("div",{className:`dropdown-menu ${a?"open":""}`},a?e?.map(s=>E.default.createElement("li",{key:s.value,className:`dropdown-item ${o===s.value?"selected":""}`,onClick:()=>!s.disabled&&d(s.value),onKeyDown:g=>!s.disabled&&g.key==="Enter"&&d(s.value),style:{opacity:`${n?.75:1}`}},E.default.createElement("p",{className:"encore-text"},s.label))):null)))},Lt=Er;var Tt=(e,o)=>{let t=null;return(...r)=>{t&&clearTimeout(t),t=setTimeout(()=>{e(...r)},o)}};var A=u(m()),Lr=(0,A.forwardRef)(({label:e,defaultValue:o,onChange:t,type:r,placeholder:n,settings:i,validation:a},l)=>{let[c,d]=(0,A.useState)(o||null),[s,g]=(0,A.useState)(null),f=r==="file",p=r==="number",k=(0,A.useMemo)(()=>Tt(C=>{f||t?.(C)},1e3),[t,f]),y=(0,A.useCallback)(C=>{if(f){let M=C.target.files;t?.(M)}else if(p&&i){let M=Number(C.target.value),b=i.max??100,x=i.min??0;M>b?g(`Value cannot exceed ${b}`):M<x?g(`Value cannot be less than ${x}`):g(null);let _=Math.min(Math.max(M,x),b).toString();d(_),k(_)}else{let M=C.target.value;d(M),g(null),k(M)}},[k,i,f,p,t]);return(0,A.useEffect)(()=>{s&&R(s,!0)},[s]),A.default.createElement("div",{className:"input-container"},A.default.createElement("label",{"aria-label":e,className:f?"input":"label"},A.default.createElement("input",{"aria-label":e,type:r,accept:f?i?.accept??"image/*":void 0,multiple:f?i?.multiple??!1:void 0,className:"input encore-text",value:c??"",onChange:y,placeholder:n,step:p?i?.step??1:void 0,min:p?i?.min:void 0,max:p?i?.max:void 0,ref:l,style:f?{display:"none"}:{}}),f?"Upload Image":null))}),_e=Lr;var fe=u(m()),Tr=({onChange:e,checked:o,label:t})=>fe.default.createElement("div",{className:"slider-wrapper"},fe.default.createElement("label",{className:"switch","aria-label":t},fe.default.createElement("input",{"aria-label":"toggleSwtich",type:"checkbox",checked:o,onChange:()=>{e(!o)}}),fe.default.createElement("span",{className:"slider round"}))),Nt=Tr;var J=u(m()),Nr=({title:e,tooltip:o,selectedValue:t,type:r,settings:n,children:i,style:a})=>J.default.createElement("div",{className:"card"},J.default.createElement(It,{title:e,tooltip:o,selectedValue:t}),J.default.createElement("div",{className:"children-wrapper",style:a||{}},r==="dropdown"&&J.default.createElement(Lt,{...n}),r==="input"&&J.default.createElement(_e,{...n}),r==="toggle"&&J.default.createElement(Nt,{...n}),r==="button"&&J.default.createElement(z,{...n}),i)),ye=Nr;var _t=u(m()),_r=e=>{let{children:o,className:t,...r}=e;return _t.default.createElement("div",{...r,className:`cards-wrapper ${t||""}`},o)},Ae=_r;var oe=u(m()),Y=e=>{let[o,t]=(0,oe.useState)(new Map);return oe.default.useEffect(()=>{let r=new Map;for(let n of e)r.has(n.id)||r.set(n.id,[]),r.get(n.id)?.push(n);t(r)},[e]),Array.from(o.entries()).map(([r,n])=>{let i=n.filter(a=>a.conditionalRender);return i.length>0?oe.default.createElement(Ae,{key:r,id:r,className:`${r} combine`},i[0]?.sectionName?oe.default.createElement("label",{"aria-label":i[0]?.sectionName,htmlFor:r},i[0]?.sectionName):null,i.map(a=>oe.default.createElement(ye,{key:a.id,...a.cardProps}))):null})};var I=u(m()),Ar=()=>{let{backgroundSettings:{mode:e,styles:o,customBackgroundOverride:t},colorSettings:{isDynamicColor:r,dynamicColorMode:n},setBackgroundMode:i,updateBackgroundStyle:a,setIsDynamicColor:l,setDynamicColorMode:c,setCustomBackgroundOverride:d}=S(),{isUseLocalImage:s,setUseLocalImage:g,clearSelectedLocalImage:f,selectedLocalImage:p,setSelectedLocalImage:k}=le(),[y,C]=(0,I.useState)(e),M=P=>{C(P),i(P)},[b,x]=(0,I.useState)(n),_=P=>{x(P),c(P)},W=[{id:"backgroundOption",conditionalRender:!0,cardProps:{title:"Background Option",type:"dropdown",tooltip:"Select the background mode to customize your background.",settings:{placeholder:y,selectedValue:y,options:st,onChange:M}}},...Le(o,e,a),{id:"backgroundCustomImage",sectionName:"Custom Background",conditionalRender:e==="static",cardProps:{title:"Background image",type:"input",tooltip:I.default.createElement(I.default.Fragment,null,I.default.createElement("span",null,"Use a custom URL for the background image."),I.default.createElement("span",null,"Ensure the URL is a valid image link (e.g., .jpg, .png)."),I.default.createElement("span",null,'Use "now-playing" for the now playing art image.'),I.default.createElement("span",null,'Use "current-page" for the current page art image.')),settings:{type:"text",defaultValue:t?.url||"",label:"Url",validation:P=>Ye(P),onChange:P=>{d(P)}}}},{id:"backgroundCustomImage",conditionalRender:e==="static",cardProps:{title:"Use Local Image",type:"toggle",tooltip:I.default.createElement(I.default.Fragment,null,I.default.createElement("p",null,"Import an image from your device to use as the background."),p?.dataURL?I.default.createElement("div",null,I.default.createElement("img",{width:"20rem",src:p.dataURL,alt:`${p?.fileName} img`,style:{display:"block",width:"20rem",borderRadius:"0.5rem",border:"var(--border-thickness) var(--border-style, solid) var(--border-color, rgba(var(--spice-rgb-text), 0.125))"}}),p?.fileName?I.default.createElement("p",null,"File name: ",I.default.createElement("span",null,p.fileName)):null,p?.dateAdded?I.default.createElement("p",null,"Date Added: ",I.default.createElement("span",null,p.dateAdded)):null):null),settings:{checked:s,label:"Enable Local Image",onChange:P=>{P||f(),g(P)}}}},{id:"backgroundCustomImageInput",conditionalRender:e==="static"&&s,cardProps:{title:"Select Background Image",type:"input",tooltip:"Choose an image file from your device.",settings:{type:"file",label:"Choose File",onChange:P=>{let ae=P?.[0];if(ae){let Me=new FileReader;Me.readAsDataURL(ae),Me.onload=ke=>{let xe=ke.target?.result||"";v("Local Image Data URL:",xe),R(I.default.createElement("div",{style:{display:"flex",alignItems:"center"}},I.default.createElement("span",{style:{marginRight:"10px"}},"Successfully Added Local Image as background from File name:"),I.default.createElement("span",{style:{fontWeight:"bold"}},ae.name))),k({dataURL:xe,fileName:ae.name||"",dateAdded:new Date().toLocaleString()})}}}}}},{id:"dynamicColorToggle",conditionalRender:!0,cardProps:{title:"Dynamic Color",type:"toggle",tooltip:"Enable dynamic color to adjust colors based on current playing album art.",settings:{checked:r,label:"Dynamic Color Toggle",onChange:P=>{l(P),P&&R("Enabled Dynamic Color.")}}}},{id:"dynamicColorMode",conditionalRender:r,cardProps:{title:"Dynamic Color Mode",type:"dropdown",tooltip:"Choose whether to adjust the color of all elements or just the accent color.",settings:{placeholder:b,selectedValue:b,options:lt,onChange:_}}}];return I.default.createElement(V,{title:"Background Settings",description:"Set your Spotify interface settings."},Y(W))},At=Ar;var D=u(m()),Or=()=>{let{exportSettings:e,importSettings:o}=S(),[t,r]=(0,D.useState)(!1),n=(0,D.useRef)(null),i=()=>{r(d=>!d),t&&n.current&&(n.current.value="")},a=()=>{let d=n.current?.value.trim()||"{}";if(d==="{}"){R("Please enter valid JSON settings.",!0);return}o(d)};return D.default.createElement(V,{title:"Settings Import/Export",description:"Manage your settings easily."},D.default.createElement(Ae,null,D.default.createElement(ye,{title:"Import and Export Settings",type:"normal",tooltip:"Use these buttons to import settings from a JSON file or export your current theme settings to your clipboard.",style:{display:"flex",gap:"0.5rem"}},D.default.createElement(z,{onClick:()=>{let d=e();navigator.clipboard.writeText(d).then(()=>{R("Settings exported to clipboard!")}).catch(s=>{w("Failed to copy: ",s),R("Failed to copy settings to clipboard.",!0)})}},"Export"),D.default.createElement(z,{onClick:i,variant:t?"danger":"primary"},t?"Cancel Import":"Import")),t&&D.default.createElement(ye,{title:"Import Settings JSON",type:"normal",tooltip:"Paste your JSON settings here to import them. Ensure the JSON is correctly formatted.",style:{display:"flex",gap:"0.5rem"}},D.default.createElement(z,{onClick:async()=>{try{let d=await navigator.clipboard.readText();n.current&&(n.current.value=d,a()),R("Clipboard content pasted successfully!")}catch(d){w("Failed to read clipboard: ",d),R("Failed to read clipboard content.",!0)}}},"Paste And Import"),D.default.createElement(_e,{ref:n,type:"text",label:"Paste JSON here",placeholder:"Paste JSON here"}),D.default.createElement(z,{onClick:a},"Import"))))},Ot=Or;var Bt=()=>Spicetify.Platform&&Spicetify.Platform.operatingSystem==="Windows"?!0:Spicetify.Platform?.PlatformData?.os_name?Spicetify.Platform.PlatformData.os_name.toLowerCase().includes("win"):!1,Rt=()=>Spicetify?.Config.color_scheme==="light"||!1,Dt=()=>!!(document.querySelector(".globalNav")||document.querySelector(".Root__globalNav"));async function Ut(e){try{Spicetify?.Platform?.ControlMessageAPI?._updateUiClient?.updateTitlebarHeight({height:e}),Spicetify?.Platform?.UpdateAPI?._updateUiClient?.updateTitlebarHeight({height:e}),Spicetify.CosmosAsync.post("sp://messages/v1/container/control",{type:"update_titlebar",height:`${e}px`}),j(`Control height set to ${e}px`)}catch(o){w(`Error setting control height: ${e}`,o)}}function $t(){return document.getElementById("customControls")?(document.querySelector(".lucid-transperent-window-controls")?.remove(),!0):!1}var Ft="https://api.github.com/repos/sanoojes/spicetify-lucid/releases",Vt=".Root__main-view .os-viewport, .Root__main-view .main-view-container > .main-view-container__scroll-node:not([data-overlayscrollbars-initialize]), .Root__main-view .main-view-container__scroll-node > [data-overlayscrollbars-viewport]",jt="playlist-art-image-",Ht="playlist-view-",Ke=Spicetify?.Platform?.version>="1.2.46",Gt=Rt(),re=Bt(),Wt=Dt(),Oe=$t();var L=u(m()),Br=()=>{let{interfaceSettings:{controlSettings:{height:e},fontSettings:{body:{fontFamily:o}},grainSettings:{grainEffect:t},pagesSettings:{isScrollMode:r,backgroundImageMode:n,playlistViewMode:i},borderSettings:{color:a,style:l,thickness:c,roundedRadius:d}},npvSettings:{mode:s,position:g,blur:f},setFont:p,setGrainEffect:k,setControlHeight:y,setPagesBackgroundImageMode:C,setPlaylistViewMode:M,setIsScrollMode:b,setNpvMode:x,setNpvBlur:_,setCompactNpvPosition:W,setBorderColor:P,setBorderStyle:ae,setBorderThickness:Me,settingAccessPosition:ke,setRoundedBorderRadius:xe,setSettingAccessPosition:Xo}=S(),[ot,Ko]=(0,L.useState)(t),[rt,Qo]=(0,L.useState)(n),[nt,er]=(0,L.useState)(i);return L.default.createElement(V,{title:"Interface Settings",description:"Set your Spotify interface settings."},Y([{id:"controlSettings",conditionalRender:re,cardProps:{title:"Set Control Height",tooltip:"Set the height of your window controls in pixels.",type:"input",settings:{type:"number",label:"Enter Control Height",defaultValue:e,onChange:h=>{y(Number(h))},settings:{step:1,min:1,max:64}}}},{id:"themeSettings",conditionalRender:!0,cardProps:{title:"Settings Access Position",tooltip:"Choose how to access settings: via the context menu button or a navigation button.",type:"dropdown",settings:{options:gt,placeholder:ke,selectedValue:ke,onChange:h=>{Xo(h)}}}},{id:"npvSettings",conditionalRender:!0,cardProps:{title:"Set Right Sidebar Mode",tooltip:L.default.createElement(L.default.Fragment,null,L.default.createElement("h3",{className:"encore-text encore-text-medium-bold"},"Select how the right sidebar appears during playback."),L.default.createElement("span",null,"Choose 'Compact' for a minimized view or 'Normal' for a detailed layout")),type:"dropdown",settings:{options:ft,placeholder:s,selectedValue:s,onChange:h=>{x(h)}}}},{id:"npvSettings",conditionalRender:s==="compact",cardProps:{title:"Set Compact Sidebar Position",tooltip:L.default.createElement(L.default.Fragment,null,L.default.createElement("h3",{className:"encore-text encore-text-medium-bold"},"Select where the right sidebar appears.")),type:"dropdown",settings:{options:yt,placeholder:g,selectedValue:g,onChange:h=>{W(h)}}}},{id:"npvSettings",sectionName:"Styles",conditionalRender:s==="compact",cardProps:{title:"Set Npv Background Blur",type:"input",settings:{label:"Npv Background Blur input",defaultValue:f,onChange:h=>{_(Number(h))},type:"number",settings:{max:256,min:0,step:.5}}}},{id:"font",conditionalRender:!0,cardProps:{title:"Font",type:"input",tooltip:L.default.createElement(L.default.Fragment,null,"Supports both Google Fonts via URL and local fonts.",L.default.createElement("span",null,"For Google Fonts, use the full URL (e.g., https://fonts.googleapis.com/css2?family=Roboto). "),L.default.createElement("span",null,"For local fonts, type the font family name (e.g., 'Arial').")),settings:{type:"text",label:"Font Family or URL",defaultValue:o,onChange:h=>{p("body",kt(h.toString()))}}}},{id:"grains",conditionalRender:!0,cardProps:{type:"dropdown",title:"Grains",tooltip:"Choose a grain texture mode.",settings:{options:dt,placeholder:ot,selectedValue:ot,onChange:h=>{Ko(h),k(h)}}}},{id:"pageSettings",sectionName:"Pages Setting",conditionalRender:!0,cardProps:{type:"dropdown",title:"Pages Background Image",tooltip:"Choose a background image mode for playlist pages.",settings:{options:pt,placeholder:rt,selectedValue:rt,onChange:h=>{Qo(h),C(h)}}}},{id:"pageSettings",conditionalRender:!0,cardProps:{type:"dropdown",tooltip:"Sets the view mode for playlists.",title:"Playlist View",settings:{options:ut,placeholder:nt,selectedValue:nt,onChange:h=>{er(h),M(h)}}}},{id:"pageSettings",conditionalRender:!0,cardProps:{title:"Toggle Playlist Scroll Mode",tooltip:"Enable or disable scrolling for the playlist art image.",type:"toggle",settings:{checked:r,label:"Scroll Mode Toggle",onChange:h=>{b(h)}}}},{id:"borderSettings",conditionalRender:!0,sectionName:"Border Settings",cardProps:{title:"Border Thickness",type:"input",settings:{type:"number",label:"Border Thickness",defaultValue:c,onChange:h=>{Me(Number(h))},settings:{step:1,min:0,max:8}}}},{id:"borderSettings",conditionalRender:!0,sectionName:"Border Settings",cardProps:{title:"Rounded Border Radius",type:"input",settings:{type:"number",label:"Rounded Border Radius",defaultValue:d,onChange:h=>{xe(Number(h))},settings:{step:1,min:0,max:999}}}},{id:"borderSettings",conditionalRender:!0,cardProps:{title:"Border Color",type:"input",settings:{type:"text",label:"Border Color",defaultValue:a,onChange:h=>{P(h)}}}},{id:"borderSettings",conditionalRender:!0,cardProps:{title:"Border Style",type:"dropdown",settings:{options:mt,selectedValue:l,onChange:h=>{ae(h)}}}}]))},zt=Br;var Be=u(m()),Rr=()=>{let{playbarSettings:{mode:e,styles:o},setPlaybarMode:t,updatePlaybarStyle:r}=S(),[n,i]=(0,Be.useState)(e),l=[{id:"playbarOption",conditionalRender:!0,cardProps:{title:"Playbar Option",type:"dropdown",settings:{placeholder:n,selectedValue:n,options:ct,onChange:c=>{i(c),t(c)}}}},...Le(o,e,r)];return Be.default.createElement(V,{title:"Playbar Settings",description:"Set your Spotify Now Playing Bar settings."},Y(l))},qt=Rr;var Zt=u(m()),Dr=()=>{let{resetAllSettings:e}=S();return Zt.default.createElement(V,{title:"Reset Settings",description:"Reset your theme settings."},Y([{id:"resetButtonCard",conditionalRender:!0,cardProps:{title:"Reset All Settings",type:"button",settings:{variant:"danger",size:"medium",children:"Reset",onClick:()=>{window.confirm("Are you sure you want to reset all settings to their default values? This action cannot be undone.")&&e()}}}}]))},Jt=Dr;var U=u(m()),Ur={settings:!1,changelog:!1},$r=()=>{let e=(0,U.createContext)(null);return{ModalContextProvider:({children:r})=>{let[n,i]=(0,U.useState)(Ur),a=(0,U.useCallback)(c=>{let d=n[c],s=(0,U.useCallback)(()=>{i(f=>({...f,[c]:!0}))},[c]),g=(0,U.useCallback)(()=>{i(f=>({...f,[c]:!1}))},[c]);return{isOpen:d,openModal:s,closeModal:g}},[n]),l=(0,U.useMemo)(()=>a,[a]);return U.default.createElement(e.Provider,{value:l},r)},useModal:r=>{let n=(0,U.useContext)(e);if(n)return n(r);throw new Error("Wrap Element with ModalContextProvider")}}},{ModalContextProvider:Yt,useModal:X}=$r();var H=u(m()),Fr=(0,H.memo)(()=>{let{isOpen:e,closeModal:o}=X("settings");return H.default.createElement(Pe,{title:"Lucid Settings",onClose:o,isOpen:e},H.default.createElement("div",{className:"sections-container"},H.default.createElement(At,null),H.default.createElement(zt,null),H.default.createElement(qt,null),H.default.createElement(Jt,null),H.default.createElement(Ot,null)))}),Xt=Fr;var Re=u(m()),Vr=()=>{v("hook running useSettingsAccess");let{settingAccessPosition:e}=S(),{openModal:o}=X("settings"),t=(0,Re.useRef)(null);(0,Re.useEffect)(()=>{if(e==="context-menu"&&(t.current=new Spicetify.Menu.Item("Lucid Settings",!1,o,'<svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.012 2.25c.734.008 1.465.093 2.182.253a.75.75 0 0 1 .582.649l.17 1.527a1.384 1.384 0 0 0 1.927 1.116l1.401-.615a.75.75 0 0 1 .85.174 9.792 9.792 0 0 1 2.204 3.792.75.75 0 0 1-.271.825l-1.242.916a1.381 1.381 0 0 0 0 2.226l1.243.915a.75.75 0 0 1 .272.826 9.797 9.797 0 0 1-2.204 3.792.75.75 0 0 1-.848.175l-1.407-.617a1.38 1.38 0 0 0-1.926 1.114l-.169 1.526a.75.75 0 0 1-.572.647 9.518 9.518 0 0 1-4.406 0 .75.75 0 0 1-.572-.647l-.168-1.524a1.382 1.382 0 0 0-1.926-1.11l-1.406.616a.75.75 0 0 1-.849-.175 9.798 9.798 0 0 1-2.204-3.796.75.75 0 0 1 .272-.826l1.243-.916a1.38 1.38 0 0 0 0-2.226l-1.243-.914a.75.75 0 0 1-.271-.826 9.793 9.793 0 0 1 2.204-3.792.75.75 0 0 1 .85-.174l1.4.615a1.387 1.387 0 0 0 1.93-1.118l.17-1.526a.75.75 0 0 1 .583-.65c.717-.159 1.45-.243 2.201-.252Zm0 1.5a9.135 9.135 0 0 0-1.354.117l-.109.977A2.886 2.886 0 0 1 6.525 7.17l-.898-.394a8.293 8.293 0 0 0-1.348 2.317l.798.587a2.881 2.881 0 0 1 0 4.643l-.799.588c.32.842.776 1.626 1.348 2.322l.905-.397a2.882 2.882 0 0 1 4.017 2.318l.11.984c.889.15 1.798.15 2.687 0l.11-.984a2.881 2.881 0 0 1 4.018-2.322l.905.396a8.296 8.296 0 0 0 1.347-2.318l-.798-.588a2.881 2.881 0 0 1 0-4.643l.796-.587a8.293 8.293 0 0 0-1.348-2.317l-.896.393a2.884 2.884 0 0 1-4.023-2.324l-.11-.976a8.988 8.988 0 0 0-1.333-.117ZM12 8.25a3.75 3.75 0 1 1 0 7.5 3.75 3.75 0 0 1 0-7.5Zm0 1.5a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Z" fill="#fff"/></svg>'),t.current.register()),e==="nav"&&!document.querySelector(".main-actionButtons button[aria-label='Lucid Settings']")&&!(t.current instanceof HTMLButtonElement)){let r=new Spicetify.Topbar.Button("Lucid Settings",'<svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.012 2.25c.734.008 1.465.093 2.182.253a.75.75 0 0 1 .582.649l.17 1.527a1.384 1.384 0 0 0 1.927 1.116l1.401-.615a.75.75 0 0 1 .85.174 9.792 9.792 0 0 1 2.204 3.792.75.75 0 0 1-.271.825l-1.242.916a1.381 1.381 0 0 0 0 2.226l1.243.915a.75.75 0 0 1 .272.826 9.797 9.797 0 0 1-2.204 3.792.75.75 0 0 1-.848.175l-1.407-.617a1.38 1.38 0 0 0-1.926 1.114l-.169 1.526a.75.75 0 0 1-.572.647 9.518 9.518 0 0 1-4.406 0 .75.75 0 0 1-.572-.647l-.168-1.524a1.382 1.382 0 0 0-1.926-1.11l-1.406.616a.75.75 0 0 1-.849-.175 9.798 9.798 0 0 1-2.204-3.796.75.75 0 0 1 .272-.826l1.243-.916a1.38 1.38 0 0 0 0-2.226l-1.243-.914a.75.75 0 0 1-.271-.826 9.793 9.793 0 0 1 2.204-3.792.75.75 0 0 1 .85-.174l1.4.615a1.387 1.387 0 0 0 1.93-1.118l.17-1.526a.75.75 0 0 1 .583-.65c.717-.159 1.45-.243 2.201-.252Zm0 1.5a9.135 9.135 0 0 0-1.354.117l-.109.977A2.886 2.886 0 0 1 6.525 7.17l-.898-.394a8.293 8.293 0 0 0-1.348 2.317l.798.587a2.881 2.881 0 0 1 0 4.643l-.799.588c.32.842.776 1.626 1.348 2.322l.905-.397a2.882 2.882 0 0 1 4.017 2.318l.11.984c.889.15 1.798.15 2.687 0l.11-.984a2.881 2.881 0 0 1 4.018-2.322l.905.396a8.296 8.296 0 0 0 1.347-2.318l-.798-.588a2.881 2.881 0 0 1 0-4.643l.796-.587a8.293 8.293 0 0 0-1.348-2.317l-.896.393a2.884 2.884 0 0 1-4.023-2.324l-.11-.976a8.988 8.988 0 0 0-1.333-.117ZM12 8.25a3.75 3.75 0 1 1 0 7.5 3.75 3.75 0 0 1 0-7.5Zm0 1.5a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Z" fill="currentColor"/></svg>',o,!1,!0);t.current=r}return()=>{t.current instanceof Spicetify.Menu.Item&&t.current.deregister(),t.current instanceof Spicetify.Topbar.Button&&t.current.element.remove(),document.querySelector(".Root__globalNav .main-actionButtons div:has(button[aria-label='Lucid Settings'])")?.remove()}},[e,o])},Kt=Vr;var de=u(m()),jr=(0,de.memo)(()=>{v("Render <SettingsManager />");let{isOpen:e}=X("settings");return Kt(),de.default.createElement(de.default.Fragment,null,e&&de.default.createElement(Xt,null))}),Qt=jr;var De=(e,o)=>[e,o].filter(Boolean).join(" ").trim(),Ue=e=>{if(!Object.keys(e).length)return{};let o={};return e.blur!==void 0&&(o.filter=De(o.filter,`blur(${e.blur}px)`)),e.backdropBlur!==void 0&&(o.backdropFilter=`blur(${e.backdropBlur}px)`),e.contrast!==void 0&&(o.filter=De(o.filter,`contrast(${e.contrast})`)),e.brightness!==void 0&&(o.filter=De(o.filter,`brightness(${e.brightness})`)),e.saturation!==void 0&&(o.filter=De(o.filter,`saturate(${e.saturation})`)),e.opacity!==void 0&&(o.opacity=e.opacity),e.width!==void 0&&(o.width=`${e.width}px`),e.height!==void 0&&(o.height=`${e.height}px`),(e.paddingX!==void 0||e.paddingY!==void 0)&&(o.padding=`${e.paddingY||0}px ${e.paddingX||0}px`),e.borderRadius!==void 0&&(o.borderRadius=`${e.borderRadius}px`),e.backgroundColor!==void 0&&(o.backgroundColor=`${e.backgroundColor}`),o},$e=(e,o=!1)=>{if(!Object.keys(e).length)return o?"":{};let t={};return e.blur!==void 0&&(t["--blur"]=`${e.blur}px`),e.backdropBlur!==void 0&&(t["--backdrop-blur"]=`${e.backdropBlur}px`),e.contrast!==void 0&&(t["--contrast"]=e.contrast),e.brightness!==void 0&&(t["--brightness"]=e.brightness),e.saturation!==void 0&&(t["--saturation"]=e.saturation),e.width!==void 0&&(t["--width"]=`${e.width}px`),e.height!==void 0&&(t["--height"]=`${e.height}px`),e.paddingX!==void 0&&(t["--padding-x"]=`${e.paddingX}px`),e.borderRadius!==void 0&&(t["--border-radius"]=`${e.borderRadius}px`),e.backgroundColor!==void 0&&(t["--background-color"]=e.backgroundColor),e.time!==void 0&&(t["--time"]=`${e.time}s`),e.opacity!==void 0&&(t["--opacity"]=e.opacity),o?Object.entries(t).map(([r,n])=>`${r}: ${n};`).join(" "):t};var pe=u(m()),Hr=({style:e})=>pe.default.createElement("div",{className:"animated-background-container",style:{...$e(e)}},pe.default.createElement("div",{className:"back"}),pe.default.createElement("div",{className:"backleft"}),pe.default.createElement("div",{className:"backright"}),pe.default.createElement("div",{className:"front"})),eo=Hr;var to=u(m()),Gr=({style:e})=>to.default.createElement("div",{className:"solid-background",style:{...Ue(e)}}),Qe=Gr;var Wr={underMainBackgroundImage:"",pageCategory:"other",artworkData:{nowPlayingArtURL:"",currentPageURI:"",currentPageArtURL:""},windowZoom:1},N=se(e=>({...Wr,updateArtworkData:o=>e(t=>({...t,artworkData:{...t.artworkData,...o}})),setPageCategory:o=>e(t=>({...t,pageCategory:o})),setUnderMainViewBackgroundImage:o=>e(t=>({...t,underMainBackgroundImage:o})),setIsCustomControls:o=>e(t=>({...t,isCustomControls:o})),setWindowZoom:o=>e(t=>({...t,windowZoom:o}))}));var oo=u(m()),zr=({style:e})=>{let{backgroundSettings:{customBackgroundOverride:o}}=S(),{artworkData:t}=N(),{isUseLocalImage:r,selectedLocalImage:n}=le(),i=(()=>{if(r&&n?.dataURL)return n.dataURL;let a=o.url;return a==="current-page"?t?.currentPageArtURL||t?.nowPlayingArtURL||"":!a||a.trim()===""||a==="now-playing"?t?.nowPlayingArtURL||"":a||""})();return oo.default.createElement("div",{className:"static-background",style:{backgroundImage:`url("${i}")`,...Ue(e)}})},ro=zr;var Fe=u(m()),qr={animated:eo,static:ro,solid:Qe},Zr=()=>{v("Render <BackgroundManager />");let{backgroundSettings:{mode:e,styles:o}}=S(),t=o[e],r=qr[e];return Fe.default.createElement("div",{className:"background-wrapper"},r?Fe.default.createElement(r,{style:t}):Fe.default.createElement(Qe,{style:{backgroundColor:"#202020"}}))},no=Zr;var io=async()=>{await(async()=>{for(;!Spicetify?.Player?.data;)await new Promise(n=>setTimeout(n,100))})();let{item:o}=Spicetify.Player.data;return!o||!o.metadata?(w("No item or metadata found in Spicetify Player data."),""):[o.metadata.image_xlarge_url,o.metadata.image_large_url,o.metadata.image_url,o.metadata.image_small_url].find(n=>n)||Jr()||""},Jr=()=>document.querySelector(".Root__right-sidebar .main-nowPlayingView-nowPlayingWidget .main-image-image")?.src||"",Yr=async e=>{let t=0;for(;t<=3;)try{let r=await Spicetify.GraphQL.Request({name:"queryArtistOverview",operation:"query",sha256Hash:"35648a112beb1794e39ab931365f6ae4a8d45e65396d641eeda94e4003d41497",value:null},{uri:e,includePrerelease:!0,locale:null});if(r)return r}catch(r){if(r instanceof Error&&r.message.includes("DUPLICATE_REQUEST_ERROR")&&t<3){t++,Ne(`Duplicate request detected (getArtistMetaData). Retrying in 1 second... (Attempt ${t})`),await new Promise(n=>setTimeout(n,1e3));continue}throw w("Error fetching artist metadata:",r),r}},Xr=async e=>{let t=0;for(;t<=3;)try{let r=await Spicetify.GraphQL.Request({name:"getAlbum",operation:"query",sha256Hash:"469874edcad37b7a379d4f22f0083a49ea3d6ae097916120d9bbe3e36ca79e9d",value:null},{uri:e,locale:null,offset:0,limit:50});if(r)return r}catch(r){if(r instanceof Error&&r.message.includes("DUPLICATE_REQUEST_ERROR")&&t<3){t++,Ne(`Duplicate request detected (getAlbumMetaData). Retrying in 1 second... (Attempt ${t})`),await new Promise(n=>setTimeout(n,1e3));continue}throw w("Error fetching album metadata:",r),r}},ao=e=>{let o=Spicetify.URI.isPlaylistV1OrV2(e),t=Spicetify.URI.isArtist(e),r=Spicetify.URI.isAlbum(e),n=Spicetify.URI.isShow(e),i=Spicetify.URI.isProfile(e);if(o||t||r||i||n){let a=e.match(/\/(?:playlist|artist|album|user|show)\/([^/]+)/)?.[1];return a?`spotify:${o?"playlist":t?"artist":r?"album":n?"show":"user"}:${a}`:(Ne("No ID found in pathname:",e),null)}return null},so=async e=>{let o=e.split(":")[1];try{switch(o){case"playlist":case"show":return(await Spicetify.Platform.PlaylistAPI.getMetadata(e)).images.find(r=>r.url)?.url||null;case"artist":{let t=await Yr(e);return t.data?.artistUnion.visuals.headerImage?.sources?.[0]?.url||t.data?.artistUnion.visuals.avatarImage?.sources?.[0]?.url||null}case"album":{let t=await Xr(e);return t.data?.albumUnion.coverArt.sources?.[2]?.url||t.data?.albumUnion.coverArt.sources?.[0]?.url||null}case"user":return(await Spicetify.Platform.RequestBuilder.build().withHost("https://spclient.wg.spotify.com/user-profile-view/v3").withPath(`/profile/${e.split(":")[2]}`).send())?.body?.image_url||null;default:return null}}catch(t){return w(`Error fetching artwork for ${o}:`,t),null}};var ue=u(m()),Kr=()=>{v("Render <ArtworkManager />");let{pageCategory:e,artworkData:o,updateArtworkData:t}=N(),{interfaceSettings:{pagesSettings:r}}=S(),n=(0,ue.useCallback)(async()=>{let i=Spicetify.Platform.History.location.pathname,a=ao(i);if(o.currentPageURI!==a){document.documentElement.style.setProperty("--artwork-opacity","0");try{if(a){let l=await so(a)||"";t({currentPageArtURL:l,currentPageURI:a})}else t({currentPageArtURL:"",currentPageURI:""})}catch(l){w("Error updating artwork:",l),t({currentPageArtURL:"",currentPageURI:""})}finally{setTimeout(()=>document.documentElement.style.setProperty("--artwork-opacity","1"),500)}}},[o.currentPageURI,t]);return(0,ue.useEffect)(()=>{if(o.currentPageArtURL?(document.documentElement.style.setProperty("--playlist-art-image",`url(${o.currentPageArtURL})`),j(`Updated Playlist Artwork URL to ${o.currentPageArtURL}`)):o.currentPageURI&&e!=="other"&&(w(`No artwork URL found for URI: ${o.currentPageURI}`),document.documentElement.style.setProperty("--playlist-art-image","none")),r.backgroundImageMode==="inherit"){let i=Spicetify.Platform.History.listen(n);return n(),()=>{i()}}},[r.backgroundImageMode,o.currentPageArtURL,o.currentPageURI,e,n]),(0,ue.useEffect)(()=>{o.nowPlayingArtURL&&(document.documentElement.style.setProperty("--now-playing-art-image",`url("${o.nowPlayingArtURL}")`),j(`Updated Now Playing Art View: ${o.nowPlayingArtURL}`))},[o.nowPlayingArtURL]),(0,ue.useEffect)(()=>{let i=async()=>{let a=await io();t({nowPlayingArtURL:a})};return i(),Spicetify.Player.addEventListener("songchange",i),()=>{Spicetify.Player.removeEventListener("songchange",i)}},[t]),null},lo=Kr;var co=u(m()),Qr=()=>{let{interfaceSettings:{borderSettings:e}}=S();return(0,co.useEffect)(()=>{let t=(r=>Object.keys(r).length?Object.entries(r).map(([n,i])=>`--border-${n}: ${n==="thickness"||n==="roundedRadius"?`${i}px`:i};`).join(" "):"")(e);document.documentElement.style.cssText+=t},[e]),null},po=Qr;var be=(e,o,t)=>`#${(e<<16|o<<8|t).toString(16).padStart(6,"0")}`,uo=(e,o,t)=>{let[r,n,i]=[e/255,o/255,t/255],[a,l,c]=[r<=.03928?r/12.92:((r+.055)/1.055)**2.4,n<=.03928?n/12.92:((n+.055)/1.055)**2.4,i<=.03928?i/12.92:((i+.055)/1.055)**2.4];return .2126*a+.7152*l+.0722*c},Se=(e,o)=>({...e,r:Math.max(0,Math.round(e.r*o)),g:Math.max(0,Math.round(e.g*o)),b:Math.max(0,Math.round(e.b*o)),hex:be(Math.max(0,Math.round(e.r*o)),Math.max(0,Math.round(e.g*o)),Math.max(0,Math.round(e.b*o)))}),G=(e,o)=>({...e,r:Math.min(255,Math.round(e.r+(255-e.r)*o)),g:Math.min(255,Math.round(e.g+(255-e.g)*o)),b:Math.min(255,Math.round(e.b+(255-e.b)*o)),hex:be(Math.min(255,Math.round(e.r+(255-e.r)*o)),Math.min(255,Math.round(e.g+(255-e.g)*o)),Math.min(255,Math.round(e.b+(255-e.b)*o)))});var Ve=(e,o)=>{let t=uo(e.r,e.g,e.b),r=uo(o.r,o.g,o.b),n=Math.max(t,r),i=Math.min(t,r);return(n+.05)/(i+.05)},he=(e,o,t)=>{let{r,g:n,b:i}=e,a=Math.max(r,n,i),l=Math.min(r,n,i);if(a-l===0)return e;let d=Math.max(0,Math.min(r+(r-l)*o)),s=Math.max(0,Math.min(n+(n-l)*o)),g=Math.max(0,Math.min(i+(i-l)*o));return{...e,r:Math.min(255,Math.round(d+(255-d)*t)),g:Math.min(255,Math.round(s+(255-s)*t)),b:Math.min(255,Math.round(g+(255-g)*t)),hex:be(Math.min(255,Math.round(d+(255-d)*t)),Math.min(255,Math.round(s+(255-s)*t)),Math.min(255,Math.round(g+(255-g)*t)))}};var je=u(yo());async function mn(e){try{let o=await(0,je.loadImage)(e),t=10,r=Math.max(o.width/t,10),n=Math.max(o.height/t,10),a=(0,je.createCanvas)(r,n).getContext("2d");a.drawImage(o,0,0,r,n);let c=a.getImageData(0,0,r,n).data,d={},s={},f=Math.floor(c.length*.2);for(let b=0;b<f;b+=4){let x=c[b],_=c[b+1],W=c[b+2],P=`${x}-${_}-${W}`;d[P]=(d[P]||0)+1,s[P]={r:x,g:_,b:W,hex:be(x,_,W)}}let p=Object.entries(d).sort((b,x)=>x[1]-b[1]).map(([b])=>s[b]),k=p[0],y=p[1],C=p[2],M=2;for(;!y||Ve(k,y)<2.5;){if(M>=p.length){y=G(k,.2);break}y=p[M],M++}for(;!C||Ve(k,C)<2.5||Ve(y,C)<2.5;){if(M>=p.length){C=G(y,.2);break}C=p[M],M++}return{baseColor:k,secondaryColor:y,tertiaryColor:C}}catch(o){return w("Error extracting colors: ",o),o}}var tt=null;async function bo(e,o,t,r){return!o||!r?null:new Promise(n=>{tt&&clearTimeout(tt),tt=setTimeout(async()=>{try{let i=await mn(r);if(i instanceof Error){w(`Error extracting colors: ${i.message}`),n(null);return}let a=fn(i,t);gn(e,a,t),n(i)}catch(i){w("Error saving colors to style: ",i instanceof Error?i.message:i),n(null)}},200)})}function gn(e,o,t){let r=`:root {${Object.entries(o).map(([n,i])=>`
--spice-${n}: ${i.hex} !important;
--spice-rgb-${n}: ${i.r}, ${i.g}, ${i.b} !important;`).join("")}
}`;t==="full"?r+=`:root{
will-change: --spice-main,--spice-rgb-main,--spice-sidebar,--spice-rgb-sidebar,--spice-card,--spice-rgb-card,--spice-player,--spice-rgb-player,--spice-accent,--spice-rgb-accent,--spice-highlight,--spice-rgb-highlight,--spice-button,--spice-rgb-button,--spice-button-active,--spice-rgb-button-active,--spice-text,--spice-rgb-text,--spice-progress-bar,--spice-rgb-progress-bar,--spice-subtext,--spice-rgb-subtext,--spice-primary,--spice-rgb-primary,--spice-secondary,--spice-rgb-secondary,--spice-tertiary,--spice-rgb-tertiary;
transition: var(--spice-transition, all 0.3s ease-in-out);
}`:r+=`:root{
will-change: --spice-accent,--spice-rgb-accent,--spice-button,--spice-rgb-button,--spice-progress-bar,--spice-rgb-progress-bar,--spice-button-active,--spice-rgb-button-active,--spice-progress-bar,--spice-rgb-progress-bar,--spice-primary,--spice-rgb-primary,--spice-secondary,--spice-rgb-secondary,--spice-tertiary,--spice-rgb-tertiary;
transition: var(--spice-transition, all 0.3s ease-in-out);
}`,e.textContent=r}function So(e,o){o==="full"?e.textContent=`:root{
will-change: --spice-main,--spice-rgb-main,--spice-sidebar,--spice-rgb-sidebar,--spice-card,--spice-rgb-card,--spice-player,--spice-rgb-player,--spice-accent,--spice-rgb-accent,--spice-highlight,--spice-rgb-highlight,--spice-button,--spice-rgb-button,--spice-button-active,--spice-rgb-button-active,--spice-text,--spice-rgb-text,--spice-progress-bar,--spice-rgb-progress-bar,--spice-subtext,--spice-rgb-subtext,--spice-primary,--spice-rgb-primary,--spice-secondary,--spice-rgb-secondary,--spice-tertiary,--spice-rgb-tertiary;
transition: all 0.3s ease-in-out;
}`:e.textContent=`:root{
will-change: --spice-accent,--spice-rgb-accent,--spice-button,--spice-rgb-button,--spice-progress-bar,--spice-rgb-progress-bar,--spice-button-active,--spice-rgb-button-active,--spice-progress-bar,--spice-rgb-progress-bar,--spice-primary,--spice-rgb-primary,--spice-secondary,--spice-rgb-secondary,--spice-tertiary,--spice-rgb-tertiary;
transition: all 0.3s ease-in-out;
}`}function fn({baseColor:e,secondaryColor:o,tertiaryColor:t},r){return r==="full"?{main:Se(o,.4),sidebar:Se(o,.5),card:Se(t,.5),player:Se(o,.6),"progress-bar":G(o,.6),accent:G(e,.4),highlight:G(o,.2),button:G(t,.4),"button-active":G(t,.4),text:G(e,.9),subtext:G(o,.9),primary:e,secondary:o,tertiary:t}:{accent:he(e,4,.2),button:he(t,4,.2),"progress-bar":he(o,6,.3),"button-active":he(t,4,.2),primary:e,secondary:o,tertiary:t}}var ne=u(m()),yn=()=>{v("Render <ColorManager />");let{colorSettings:{isDynamicColor:e,dynamicColorMode:o}}=S(),{artworkData:t}=N(),{selectedLocalImage:r,isUseLocalImage:n}=le(),i=(0,ne.useRef)(null),a=(0,ne.useRef)(null),l=(0,ne.useRef)(null);return(0,ne.useEffect)(()=>(i.current=document.createElement("style"),i.current.id="lucid_dynamic_colors",document.head.appendChild(i.current),()=>{i.current&&document.head.removeChild(i.current)}),[]),(0,ne.useEffect)(()=>{if(!e){a.current&&(a.current=null),i.current&&So(i.current,o);return}e&&(t.nowPlayingArtURL!==a.current||r?.dataURL||o!==l.current)&&(i?.current&&e&&t.nowPlayingArtURL&&bo(i.current,e,o,n&&r?.dataURL||t.nowPlayingArtURL).then(()=>{j("Dynamic colors updated!")}).catch(c=>{w("Error updating colors:",c)}),a.current=n&&r?.dataURL||t.nowPlayingArtURL,l.current=o)},[e,o,t.nowPlayingArtURL,r?.dataURL,n]),null},ho=yn;var we=u(m()),bn=()=>{let{interfaceSettings:{fontSettings:e}}=S(),o=(0,we.useCallback)((r,n)=>{document.documentElement.style.setProperty(`--${r}-font-to-use`,n)},[]),t=(0,we.useCallback)(async r=>{let{fontFamily:n,url:i}=e[r];try{await Mt(i,`${r}-font`),o(r,n)}catch(a){w(`Failed to load font from ${i}`,a),o(r,n)}},[e,o]);return(0,we.useEffect)(()=>{Object.keys(e).map(r=>t(r))},[e,t]),null},vo=bn;var wo=u(m()),O=e=>{(0,wo.useEffect)(()=>{if(e)return document.body.classList.add(e),()=>{document.body.classList.remove(e)}},[e])};var Sn=()=>(v("Render <GlobalNavManager />"),O(Wt?"global-nav":"control-nav"),null),Co=Sn;var Mo=u(m()),hn=()=>{v("Render <GrainManager />");let{interfaceSettings:{grainSettings:{grainEffect:e}}}=S();return O(`grain-${e}`),Mo.default.createElement("div",{id:"grainEffect","data-grainEffect":e})},ko=hn;var vn=()=>{let{npvSettings:{mode:e,position:o,blur:t}}=S();return document.body.style.setProperty("--compact-npv-blur",`${t}px`),O(`${e}-npv`),O(`${o}-npv`),null},xo=vn;var Po=e=>Spicetify.URI.isPlaylistV1OrV2(e)?"playlist":Spicetify.URI.isArtist(e)?"artist":Spicetify.URI.isAlbum(e)?"album":Spicetify.URI.isGenre(e)?"genre":Spicetify.URI.isShow(e)?"show":Spicetify.URI.isSearch(e)?"search":Spicetify.URI.isProfile(e)?"profile":Spicetify.URI.isConcert(e)||Spicetify.URI.isArtistConcerts(e)?"concert":"other";var Io=u(m()),wn=()=>{let{pageCategory:e,setPageCategory:o}=N();return O(e),(0,Io.useEffect)(()=>{let t=()=>{let n=Spicetify.Platform.History.location.pathname;o(Po(n))};t();let r=Spicetify.Platform.History.listen(()=>{t()});return()=>{r()}},[o]),null},Eo=wn;var He=u(m()),Lo=".Root__now-playing-bar",Cn=()=>{let{playbarSettings:e}=S(),o=(0,He.useRef)(document.querySelector(Lo));return O(`playbar-${e.mode}`),(0,He.useEffect)(()=>{if(!o.current){w(`Playbar element with class '${Lo}' not found!`);return}let{mode:t,styles:r}=e,n=$e(r[t],!0),i=t==="compact"?r[t].height:o.current?.clientHeight||r[t]?.height;document.documentElement.style.setProperty("--playbar-height",`${i}px`),o.current.style.cssText=n.toString()},[e]),null},To=Cn;var Ce=u(m()),Mn=()=>{let{underMainBackgroundImage:e,setUnderMainViewBackgroundImage:o}=N(),t=(0,Ce.useCallback)(r=>{let n=r.reduce((a,l)=>{if(a)return a;if(l.type==="childList"&&l.addedNodes.length>0){let c=l.addedNodes[0];if(c.firstChild instanceof HTMLDivElement)return c.firstChild}return null},null),i=null;n?.style?i=n.style.backgroundImage.replace(/url\(['"]?([^'"]*)['"]?\)/i,"$1"):e!==null&&(i=null),o(i)},[o,e]);(0,Ce.useEffect)(()=>{let r=new MutationObserver(t),n=document.querySelector(".under-main-view");return n&&r.observe(n,{childList:!0}),()=>r.disconnect()},[t]),(0,Ce.useEffect)(()=>(document.documentElement.style.setProperty("--under-main-view-art-image",e?`url(${e})`:null),()=>{document.documentElement.style.removeProperty("--under-main-view-art-image")}),[e])},No=Mn;var $=u(m()),kn=()=>{let{interfaceSettings:{pagesSettings:{playlistViewMode:e,isScrollMode:o,backgroundImageMode:t}}}=S(),{pageCategory:r,underMainBackgroundImage:n,artworkData:i}=N(),a=(0,$.useRef)(null),l=(0,$.useRef)(null);O(`${Ht}${e}`),O(`${jt}${t}`),O(`${n?"under-main-view-present":""}`);let c=(0,$.useCallback)(f=>{let{current:p}=a;if(p){let k=Math.min(f.scrollTop,window.innerHeight);p.style.transform=`translate3d(0, ${o?-k:0}px, 0)`,p.style.setProperty("--scroll",`${k/1e3}`)}},[o]),d=(0,$.useMemo)(()=>r!=="artist"&&!n?4:0,[r,n]);(0,$.useEffect)(()=>{let{current:f}=l;f&&f.style.setProperty("--blur",`${d}px`)},[d]),(0,$.useEffect)(()=>{let f=document.querySelector(Vt);if(f){let p=()=>c(f);return p(),f.addEventListener("scroll",p,{passive:!0}),()=>{f.removeEventListener("scroll",p)}}},[c]),v("New underMainBackgroundImage:",n);let s=r!=="other"&&t!=="none"?n||(t==="inherit"?i.currentPageArtURL||"":i.nowPlayingArtURL||""):"none",g=`playlist-art-container ${e} ${t}`;return $.default.createElement("span",{id:"playlistArtContainer",className:g,"data-playlist-view-mode":e,ref:a},$.default.createElement("div",{className:"background",ref:l,style:{backgroundImage:`url(${s})`}}),$.default.createElement("div",{className:"overlay",style:{height:"100%",width:"100%",position:"absolute",inset:0}}))},_o=kn;var me=u(m()),Ao=()=>{let e=(0,me.useRef)(null);(0,me.useEffect)(()=>{let o=()=>{if(document.getElementById("lucid-under-main-view"))return;let r=document.createElement("div");r.id="lucid-under-main-view",r.className="lucid-under-main-view";let n=document.querySelector(".main-view-container");n&&n.prepend(r),e.current=r,e.current&&Spicetify.ReactDOM.createRoot(e.current).render(me.default.createElement(_o,null))};o();let t=Spicetify.Platform.History.listen(()=>{o()});return()=>{t()}},[])};var xn=()=>(v("Render <UnderMainViewManager />"),Ao(),No(),null),Oo=xn;var K=u(m()),Pn=()=>{let e=(0,K.useRef)(null),[o,t]=(0,K.useState)({}),{windowZoom:r}=N(),{interfaceSettings:{controlSettings:{height:n}}}=S();return(0,K.useEffect)(()=>{let i=()=>{if(re)if(Ut(n),!Oe&&!Gt){let c=n||(Ke?32:64),d=Ke?(n/r-Math.min(32/r,n/r))/2:0,s=c/r-d*2;window.document.body.style.setProperty("--top-bar-padding-start",`${(n<=16?8:64)/r}px`),window.document.body.style.setProperty("--top-bar-padding-end",`${(n<=16?8:135)/r}px`);let g={position:"fixed",right:0,top:`${d}px`,height:`${s}px`,width:`${135/r}px`,WebkitBackdropFilter:"brightness(2.12)",backdropFilter:"brightness(2.12)",pointerEvents:"none",zIndex:"var(--above-main-and-now-playing-view-grid-area, 6)"};t(g)}else t({})};i();let a=()=>{i()},l=setTimeout(i,1e3);return window.addEventListener("resize",a),()=>{clearTimeout(l),window.removeEventListener("resize",a)}},[r,n]),K.default.createElement("div",{ref:e,style:o})},Bo=Pn;var ie=u(m()),In=(0,ie.memo)(()=>ie.default.createElement(ie.default.Fragment,null,re?ie.default.createElement("div",{id:"transperent-controls-container",style:{containerType:"normal",pointerEvents:"none"}},!Oe&&re?ie.default.createElement(Bo,null):null):null)),Ro=In;var Z=u(m()),En=()=>{let e=(0,Z.useRef)({outerWidth:window.outerWidth,innerWidth:window.innerWidth,ratio:window.devicePixelRatio}),{windowZoom:o,setWindowZoom:t}=N(),r=(0,Z.useRef)(window.outerWidth),n=(0,Z.useRef)(window.innerWidth),i=(0,Z.useRef)(window.devicePixelRatio),a=(0,Z.useRef)(!0),l=(0,Z.useRef)(document.querySelector(".Root__main-view"));return(0,Z.useEffect)(()=>{let c=()=>{document.documentElement.style.setProperty("--main-view-height",`${l.current?.clientHeight}px`);let s=window.outerWidth,g=window.innerWidth,f=window.devicePixelRatio;if(a.current||(r.current<=160||i.current!==f)&&(r.current!==s||n.current!==g)){let p=s/g||1;t(p),document.documentElement.style.setProperty("--zoom",`${p}`),v(`Zoom Updated: ${s} / ${g} = ${p}`),r.current=s,n.current=g,i.current=f}},d=()=>{c()};return c(),window.addEventListener("resize",d),()=>{window.removeEventListener("resize",d)}},[t]),null},Do=En;var B=u(m()),Ln=()=>(v("Render <MainStateManager />"),B.default.createElement(B.default.Fragment,null,B.default.createElement(Eo,null),B.default.createElement(ko,null),B.default.createElement(ho,null),B.default.createElement(Do,null),B.default.createElement(To,null),B.default.createElement(lo,null),B.default.createElement(po,null),B.default.createElement(Co,null),B.default.createElement(vo,null),B.default.createElement(xo,null),B.default.createElement(Oo,null),B.default.createElement(Ro,null))),Uo=Ln;function $o(e,o){e.innerHTML=`
    #lucid-main .background-container .background-wrapper div { z-index: ${o} !important; }
  `}function Fo(e){e.innerHTML=`
    #lucid-main .background-container .background-wrapper div { z-index: -1 !important; }
  `}function Vo(e,o,t,r){let n=!1,i=null,a=new MutationObserver(()=>{let c=e.querySelector(o);c!==i&&(c&&!n?(j(`Applying background z-index: ${r}`),n=!0,$o(t,r)):n&&(j(`Removing background z-index: ${r}`),n=!1,document.querySelector("#lyrics-cinema .lyrics-lyrics-background, #lyrics-cinema .lyrics-lyrics-container")?$o(t,5):Fo(t)),i=c)}),l={childList:!0};a.observe(e,l),Fo(t)}var jo=()=>{let e=document.getElementById("lucid-background-style");e||(e=document.createElement("style"),e.id="lucid-background-style",document.head.appendChild(e));let o=document.querySelector("#lyrics-cinema");o&&Vo(o,"#lyrics-cinema .lyrics-lyrics-background, #lyrics-cinema .lyrics-lyrics-container",e,5);let t=document.querySelector("#main .Root > div:last-child");t&&Vo(t,'.Root div[data-testid="fullscreen-mode-container"], .Root .npv-main-container',e,15)};var Ho=()=>{let{Locale:e}=Spicetify;function o(x){return x.replace(/[{0}{1}]/g,"").trim()}if(!e)return;let t=e.get("playlist.a11y.play")||"";t=o(t);let r=e.get("playlist.a11y.pause")||"";r=o(r);let n=e.get("play"),i=e.get("pause"),a=e.get("browse"),l=e.get("playback-control.skip-forward"),c=e.get("playback-control.skip-back"),d=e.get("tracklist.a11y.play")||"",s=e.get("view.web-player-home"),g=e.get("upgrade.tooltip.title")||"Upgrade to Premium",f,p;["zh-CN","zh-TW","am","fi"].includes(e.getLocale())?[f,p]=d.split("{1}"):[f,p]=d.split("{0}"),f=o(f),p=o(p);let k=e.get("playback-control.enable-repeat"),y=e.get("playback-control.enable-repeat-one"),C=e.get("playback-control.disable-repeat"),M="lucid_button_styles",b=document.getElementById(M);b||(b=document.createElement("style"),b.id=M,document.head.appendChild(b)),b.innerHTML=`
.Root__globalNav button[aria-label="${g}"],
.Root__globalNav button[title="${g}"] {
  display: none !important;
}

.main-repeatButton-button[aria-checked="false"],
.player-controls__right button[aria-label*="${k}"]  span{
  -webkit-mask-image: var(--repeat-off-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/repeat-off.svg"));
  mask-image: var(--repeat-off-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/repeat-off.svg"));
  background-color: var(--spice-subtext);
  mask-size: contain;
}

.main-repeatButton-button[aria-checked="mixed"],
.player-controls__right button[aria-label*="${C}"] span {
  -webkit-mask-image: var(--repeat-mixed-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/repeat-mixed.svg"));
  mask-image: var(--repeat-mixed-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/repeat-mixed.svg"));
  background-color: var(--spice-accent);
  mask-size: contain;
}

.main-repeatButton-button[aria-checked="true"],
.player-controls__right button[aria-label*="${y}"] span {
  -webkit-mask-image: var(--repeat-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/repeat.svg"));
  mask-image: var(--repeat-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/repeat.svg"));
  background-color: var(--spice-accent);
  mask-size: contain;
}

.player-controls__right button[aria-label*="${C}"] svg,
.player-controls__right button[aria-label*="${k}"] svg {
  transform: scale(1.15);
}

.player-controls__right button[aria-label*="${C}"] svg,
.player-controls__right button[aria-label*="${k}"] svg {
  visibility: hidden;
  opacity: 0;
}

.main-repeatButton-button {
  transform: scale(0.65) !important;
}

.player-controls__right, 
.player-controls__left {
    align-items: center;
}

.player-controls__buttons>button[aria-label*="${n}"] span,
.main-playButton-button[aria-label*="${n}"],
.main-playButton-PlayButton>button[aria-label*="${n}"]{
  background-color: var(--spice-text) !important;
  -webkit-mask-image: var(--play-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/play.svg")) !important;
  mask-image: var(--play-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/play.svg")) !important;
}

.main-playButton-button[aria-label*="${i}"],
.main-playButton-PlayButton>button[aria-label*="${i}"],
.main-playPauseButton-button[aria-label*="${i}"],
.player-controls__buttons>button[aria-label*="${i}"] span {
  background-color: var(--spice-text) !important;
  -webkit-mask-image: var(--pause-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/pause.svg")) !important;
  mask-image: var(--pause-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/pause.svg")) !important;
}

.Root__globalNav button:is([aria-label="Clear search field"]) {
  background-color: transparent !important;
  border: none !important;
}

button[aria-label="${a}"] path {
  display: none !important;
}

button[aria-label="${a}"] svg {
  -webkit-mask-size: contain;
  mask-size: contain;
  -webkit-mask-position: center;
  mask-position: center;
  -webkit-mask-image: var(--compass-outline-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/compass-outline.svg"));
  mask-image: var(--compass-outline-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/compass-outline.svg"));
  background-color: var(--spice-subtext) !important;
  scale: 1.25;
}

.main-repeatButton-button[aria-label="${k}"],
.main-repeatButton-button[aria-label="${C}"],
.main-repeatButton-button[aria-label="${y}"],
{
scale: 0.75 !important;
background-color: var(--spice-subtext) !important;
color: var(--spice-subtext);

svg {
  display: none;
}
}

.player-controls__buttons>button[aria-label*="${n}"] span,
.player-controls__buttons>button[aria-label*="${i}"] span{
  display: block;
  mask-size: 100%;
  -webkit-mask-position: center center;
  mask-position: center center;
  background-color: var(--spice-subtext);
  -webkit-mask-repeat: no-repeat;
  mask-repeat: no-repeat;
  -webkit-mask-size: cover;
  mask-size: cover;
  aspect-ratio: 1/1;
}

.main-playPauseButton-button,
.player-controls button[aria-label="${c}"],
.player-controls button[aria-label="${l}"]
{
  display: block;
  mask-size: 100%;
  -webkit-mask-position: center center;
  mask-position: center center;
  background-color: var(--spice-subtext);
  -webkit-mask-repeat: no-repeat;
  mask-repeat: no-repeat;
  -webkit-mask-size: cover;
  mask-size: cover;
  min-height: 1rem;
  min-width: 1rem;
  aspect-ratio: 1/1;
  border-radius: 0 !important;
  border: none !important;
  height: var(--button-size, 24px);
  width: var(--button-size, 24px);
  
  svg,
  span {
    display: none;
    visibility: hidden;
  }
}

.player-controls__buttons>button[aria-label*="${n}"] span svg,
.player-controls__buttons>button[aria-label*="${i}"] span svg {
  display: none;
  visibility: hidden;
}

.player-controls button[aria-label="${c}"] span,
.player-controls button[aria-label="${l}"] span {
  opacity: 0;
}

.player-controls button[aria-label="${c}"] {
  background-color: var(--spice-text);
  -webkit-mask-image: var(--prev-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/prev.svg"));
  mask-image: var(--prev-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/prev.svg"));
}

.player-controls button[aria-label="${l}"] {
  background-color: var(--spice-text);
  -webkit-mask-image: var(--next-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/next.svg"));
  mask-image: var(--next-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/next.svg"));
}

.main-yourLibraryX-navLink[aria-label="${s}"] svg,
button[aria-label="${s}"] svg {
  path {
display: none !important;
  }

  mask-image: var(--home-outline-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/home-outline.svg"));
  -webkit-mask-image: var(--home-outline-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/home-outline.svg"));
  background-color: var(--spice-subtext) !important;
}


.main-yourLibraryX-navLink[aria-label="${s}"].active svg,
.main-globalNav-navLinkActive[aria-label="${s}"] svg {
  path {
display: none !important;
  }

  mask-image: var(--home-filled-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/home-filled.svg"));
  -webkit-mask-image: var(--home-filled-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/home-filled.svg"));
  background-color: var(--spice-text) !important;
}

.main-yourLibraryX-navLink[aria-label="${s}"].active svg {
  path {
display: none !important;
  }

  background-color: var(--spice-accent) !important;
}

#context-menu ul[aria-label*="Add to playlist menu"] {
  p {
max-width: 10rem;
  }
}

#fs-button svg {
  path {
    display: none !important;
  }
  
  height: 16px;
  width: 16px;
  display: flex;
  background-color: currentColor !important;
  -webkit-mask-image: var(--fullscreen-noarrows-icon, url("https://cdn.jsdelivr.net/gh/OxygenEgg/wild-lucid@main/assets/icons/fullscreen-noarrows.svg"));
  mask-image: var(--fullscreen-noarrows-icon, url("https://cdn.jsdelivr.net/gh/OxygenEgg/wild-lucid@main/assets/icons/fullscreen-noarrows.svg"));
}
`};var F=u(m());var Q=u(m()),Tn=({releases:e,isLoading:o,error:t})=>o?Q.default.createElement("div",null,"Loading release data..."):t?Q.default.createElement("div",null,"Error fetching release data: ",t.message):e?Q.default.createElement("div",{className:"lucid-changelog",id:"lucid-changelog"},e.map(r=>Q.default.createElement("div",{key:r.tag_name,className:"release"},Q.default.createElement("button",{className:"release-button",type:"button",onClick:()=>window.open(r.html_url,"_blank")},"View on GitHub"),r.body&&Q.default.createElement("div",{className:"release-content",dangerouslySetInnerHTML:{__html:r.body}})))):Q.default.createElement("div",null,"No release data found."),Go=Tn;var Ge=u(m()),Wo=(e,o)=>{let[t,r]=(0,Ge.useState)(()=>{if(typeof window<"u"){let n=window.localStorage.getItem(e);return n?JSON.parse(n):o}return o});return(0,Ge.useEffect)(()=>{typeof window<"u"&&window.localStorage.setItem(e,JSON.stringify(t))},[e,t]),[t,r]};async function zo(e,o,t){try{let r={text:e,context:`${o}/${t}`,mode:"gfm"},n=await fetch("https://api.github.com/markdown",{method:"POST",body:JSON.stringify(r)});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);return await n.text()}catch(r){return w("Error parsing markdown:",r),null}}var ee=u(m()),Nn=({currentVersion:e})=>{let[o,t]=ee.default.useState({isLoading:!0,error:null,releases:null}),[r,n]=Wo("lucid:previousVersion",null),{closeModal:i,isOpen:a,openModal:l}=X("changelog"),c=async()=>{v("Fetching release data..."),t(s=>({...s,isLoading:!0}));try{let s=await fetch(Ft||"https://api.github.com/repos/sanoojes/spicetify-lucid/releases");if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);let g=await s.json();v("Fetched release data:",g);let f=await Promise.all(g.map(async k=>({...k,body:await zo(k.body,"sanoojes","spicetify-lucid")||""})));t({isLoading:!1,error:null,releases:f});let p=g[0].tag_name;(r===null||p!==r)&&(console.log("Opening changelog modal because new version detected"),l())}catch(s){t(g=>({...g,isLoading:!1,error:s instanceof Error?s:new Error("Unknown error")})),w("Error fetching release data:",s)}};ee.default.useEffect(()=>{c()},[]);let d=ee.default.useCallback(()=>{i();let s=o.releases?.[0]?.tag_name;s&&n(s)},[i,o.releases,n]);return ee.default.createElement(ee.default.Fragment,null,ee.default.createElement(Pe,{title:"Lucid Changelog",onClose:d,isOpen:a},ee.default.createElement(Go,{releases:o.releases,isLoading:o.isLoading,error:o.error,currentVersion:e})))},qo=Nn;var _n=()=>(v("Render <Main />"),(0,F.useEffect)(()=>{Ho(),jo()},[]),F.default.createElement(F.default.Fragment,null,F.default.createElement("div",{id:"background-container",className:"background-container",style:{containerType:"normal"}},F.default.createElement(no,null)),F.default.createElement(Yt,null,F.default.createElement("div",{id:"modal-container",className:"modal-container",style:{containerType:"normal"}},F.default.createElement(Qt,null),F.default.createElement(qo,null))),F.default.createElement("div",{id:"state"},F.default.createElement(Uo,null)),F.default.createElement(St,null))),Zo=_n;var Jo=u(m());async function An(){try{for(;!Spicetify?.showNotification||!Spicetify?.Player||!Spicetify?.React||!Spicetify?.Platform;)await new Promise(o=>setTimeout(o,100));let e=document.getElementById("lucid-main");e||(e=document.createElement("div"),e.id="lucid-main",document.getElementById("main")?.prepend(e)),e&&!e.hasChildNodes()&&Spicetify.ReactDOM.createRoot(e).render(Jo.default.createElement(Zo,null)),console.log("%c Lucid ignited! \u{1F680}","font-weight: bold; font-size: 1.25rem; color: #2196F3; padding: 0.5rem 0;")}catch(e){Spicetify.showNotification(`[Lucid] Error Occurred: ${e instanceof Error?e.message:e}`,!0),w(e)}}var Yo=An;(async()=>await Yo())();})();
})();